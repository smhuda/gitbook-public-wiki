# Android Application Testing

### server side:

```
/usr/bin/frida-server -l 192.168.1.4
```

client side:

```
frida-ps -H 192.168.1.4
```

Just tried with latest frida 12.1.0 and everything works fine.Connect to Device/GenyMotion Virtual Device using ADB

**Install ADB (Linux):**

```
sudo apt-get install android-tools-adb
```

**Windows:**

```
<https://dl.google.com/android/repository/platform-tools-latest-windows.zip>
```

#### Retrieve the virtual device IP address. It is displayed on top of the virtual device window:

#### From another computer, open a command prompt and run:

```
adb connect <virtual_device_IP>:5555
```

#### Find and Pull APK File:

Determine the package name of the app, e.g. "com.example.someapp". Skip this step if you already know the package name.

```
adb shell pm list packages
```

Determine the package name of the app, e.g. "com.example.someapp". Skip this step if you already know the package name.

```
adb shell pm list packages
```

Using the full path name from Step 2, pull the APK file from the Android device to the development box.

```
adb pull /data/app/com.example.someapp-2.apk path/to/desired/destination
```

### How to use ADB Shell when Multiple Devices are connected

```
$ adb devices
List of devices attached 
emulator-5554   device
7f1c864e    device
```

```
adb -s 7f1c864e shell
```

### Testing with Frida:

#### Install Frida on Windows/Linux:

```
pip install frida
```

```
pip install frida-tools
```

Make Sure GenyMotion is in **Bridged** mode and proxy is set to the Windows/Linux testing Machine IP and Port.

Install Frida Server on Mobile Device:

[https://github.com/frida/frida/releases/](https://github.com/frida/frida/releases/)

**frida-server-15.0.8-android-x86**

<mark style="color:red;">**OR: (Android ARM for One Plux X E1003 Physical Device):**</mark>

{% embed url="https://github.com/frida/frida/releases/download/15.2.2/frida-server-15.2.2-android-arm.xz" %}

Copy Frida server file into the android phone tmp directory using adb push command as shown in fig. Here I have used Genymotion as an android emulator. After the copying the file change the permissions of the frida server files.

```
adb push frida-server-downloaded /data/local/tmp/
```

Now go to ADB Shell and change permissions of Server file on the mobile device:

```
adb shell
```

```
cd /data/local/tmp
chmod 777 frida-server-downloaded

# Run the Frida Mobile Server
./frida-server-downloaded
```

## unable to connect to remote frida-server&#x20;

#### Server side:

```
/usr/bin/frida-server -l 192.168.1.4
```

#### Client side:

```
frida-ps -H 192.168.1.4
```

#### Run Frida on Your Machine and Check for packages:

```
frida-ps -Ua

OR 

frida-ps -U
```

### To connect Frida on Remote device:

```
└─# frida-ps -H 192.168.1.37    
```

### Using Frida Scripts:

```
frida --codeshare pcipolloni/universal-android-ssl-pinning-bypass-with-frida -f com.testapp.app -U
```

```
%resume
```

or use **No Pause** in script like:

```
frida --no-pause --codeshare dzonerzy/fridantiroot -f YOUR_BINARY -U
```

### Frida LOCAL JS Unpiinning Script:

{% embed url="https://redfoxsec.com/blog/android-root-detection-bypass-using-frida/" %}

```
On Device:

wget https://raw.githubusercontent.com/httptoolkit/frida-android-unpinning/main/frida-script.js

```

```
frida -l frida-script.js -f com.MyApp.android -H 192.168.1.3
```

#### Copy Pasting from Host to GenyMotion Emulator:

* **Long press the right click of your mouse until the paste sign appears**

## **Errors Troubleshooting:**

### Android: adb: Permission Denied

```makefile
D:\android-sdk-windows\platform-tools>adb shell test
test: permission denied
```

#### Restarts the adb daemon with root permissions:

```csharp
$ adb root
```

**Push Burp Cert to SD Card Downloads Folder:**

```
adb push burp.cer /data/tmp

```

#### ABD Connect:

```
adb connect 192.168.1.37:5555

```

### Check for Application Package Name:

```
adb shell pm list packages

 adb shell pm list packages | grep MyAppName

```

## Why can't I get root access from shell?

You might need to activate adb root from the developer settings menu. If you run adb root from the cmd line you can get:

root access is disabled by system setting - enable in settings -> development options

root access is disabled by system setting - enable in settings -> development options Once you activate the root option (ADB only or Apps and ADB) adb will restart and you will be able to use root from the cmd line.

You might need to activate adb root from the developer settings menu. If you run `adb root` from the cmd line you can get:

```csharp
root access is disabled by system setting - enable in settings -> development options
```

Once you activate the root option (ADB only or Apps and ADB) adb will restart and you will be able to use root from the cmd line.

### Run Frida Server Manually on Android:

```
onyx:/data/tmp # chmod 777 frida-server   
                                                                                                                                       
onyx:/data/tmp #      ./frida-server -l 192.168.1.37    
```
